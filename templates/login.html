<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Smart Cottage â€” Login</title>
<style>
  body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; background: #e8f2ff; margin: 0; }
  .container { background: #fff; padding: 24px 36px; border-radius: 12px; width: 320px; box-shadow: 0 8px 24px rgba(0,0,0,0.1); }
  h2 { margin: 0 0 12px 0; color: #1f6feb; }
  label { display: block; margin-top: 12px; font-size: 14px; }
  input { width: 100%; padding: 10px; margin-top: 6px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; }
  button { width: 100%; padding: 12px; margin-top: 20px; background: #1f6feb; color: #fff; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
  #message { margin-top: 12px; font-size: 13px; min-height: 18px; }
</style>
</head>
<body>

<div class="container">
  <h2>Smart Cottage Login</h2>
  <form id="loginForm">
    <label for="name">Name</label>
    <input type="text" id="name" required placeholder="Enter your full name">

    <label for="employee_id">Employee ID</label>
    <input type="text" id="employee_id" required placeholder="Enter Employee ID">

    <button type="submit">Login</button>
    <div id="message"></div>
  </form>
</div>

<script>
const form = document.getElementById("loginForm");
const message = document.getElementById("message");

// ðŸ”¹ Palitan ito ng deployed mobile backend URL
const MOBILE_BACKEND_URL = "https://smart-cottage-mobile.onrender.com";

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  message.style.color = "#374151";
  message.textContent = "Checking credentialsâ€¦";

  const payload = {
    name: document.getElementById("name").value.trim(),
    employee_id: document.getElementById("employee_id").value.trim()
  };

  try {
    const res = await fetch(`${MOBILE_BACKEND_URL}/api/login`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });

    const json = await res.json();

    if (res.ok && json.success) {
      message.style.color = "green";
      message.textContent = "Login successful!";

      // ðŸ”¹ Save user info locally
      localStorage.setItem("user", JSON.stringify(json.user));

      // ðŸ”¹ Redirect to main dashboard page
      setTimeout(() => {
        window.location.href = "/main.html";
      }, 800);
    } else {
      message.style.color = "#d14343";
      message.textContent = json.message || "Invalid credentials";
    }
  } catch (err) {
    message.style.color = "#d14343";
    message.textContent = "Server error, try again.";
    console.error(err);
  }
});
</script>

</body>
</html>
